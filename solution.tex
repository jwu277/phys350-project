%% Standard start of a latex document
\documentclass[letterpaper,12pt]{article}
%% Always use 12pt - it is much easier to read
%% Things written after '%' sign, are ignored by the latex editor - they are how to introduce comments into your .tex source
%% Anything mathematics related should be put in between '$' signs.

%% Set some names and numbers here so we can use them below
\newcommand{\name}{James Wu} %%%%%%%%%%%%%%% ---------> Change this to your name
\newcommand{\studentnumber}{92277235} %%%%%%%%%%%%%%% ---------> Change this to your student number

%%%%%%
%% There is a bit of stuff below which you should not have to change
%%%%%%

%% AMS mathematics packages - they contain many useful fonts and symbols.
\usepackage{amsmath, amsfonts, amssymb, bm}

%% The geometry package changes the margins to use more of the page, I suggest
%% using it because standard latex margins are chosen for articles and letters,
%% not homework.
\usepackage[paper=letterpaper,left=25mm,right=25mm,top=30mm,bottom=30mm]{geometry}
%% For details of how this package work, google the ``latex geometry documentation''.

%% Fancy headers and footers - make the document look nice
\usepackage{fancyhdr} %% for details on how this work, search-engine ``fancyhdr documentation''
\pagestyle{fancy}

\usepackage{graphicx}

\setlength{\headheight}{15pt}

%% The header
\chead{PHYS 350: Speed of Sound in a Solid} % homework number in top-centre

%% The footer
\cfoot{Page \thepage} % page in middle

%% These put horizontal lines between the main text and header and footer.
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
%%%

%%%%%%
%% The above stuff is the same as the first template, but now we are starting to prove things, so we'd like to have a
%% good proof environment that gives us nice formatting and a little square at the end.
%% We'd also like a nice Result environment that prints that up nicely too.
%% Thankfully this exists in latex in the amsthm package
\usepackage{amsthm}
\newtheorem*{thm}{Theorem}
%% This creates a new theorem-like environment called "result", that will be titled "Result".
%% See below for examples of how to use this.
%%%%%%
\usepackage{enumitem}
%% This package allows us to make nice ordered lists with numbers, letters or roman numerals

\usepackage{titlesec}
\titlespacing*{\subsection}{0pt}{0pt}{3.0ex}
\titlespacing*{\subsubsection}{0pt}{3.0ex}{0.5ex}

\usepackage[hang,flushmargin]{footmisc}

\setlength{\parindent}{0em}
\setlength{\parskip}{0.5em}

\allowdisplaybreaks

\usepackage{empheq}

\usepackage{sectsty}
\usepackage{subcaption}

\newcommand*\wfbox[1]{\fbox{\hspace{0.4em}#1\hspace{0.4em}}}

%% Useful commands
\renewcommand*{\qed}{\hfill\ensuremath{\square}}

\newcommand*{\uvec}[1]{\hat{\bm{#1}}}

\newcommand*{\deriv}[2]{\frac{d #1}{d #2}}
\newcommand*{\pderiv}[2]{\frac{\partial #1}{\partial #2}}
\newcommand*{\nderiv}[3]{\frac{d^{#3} #1}{d #2^{#3}}}
\newcommand*{\npderiv}[3]{\frac{\partial^{#3} #1}{\partial #2^{#3}}}
\newcommand*{\divg}[1]{\nabla \cdot \mathbf{#1}}

\newcommand*{\abs}[1]{\left| #1 \right|}
\newcommand*{\norm}[1]{\abs{\abs{\mathbf{#1}}}}

\newcommand*{\ev}[1]{\left<#1\right>}

\renewcommand*{\Re}[1]{\text{Re}\left(#1\right)}
\renewcommand*{\Im}[1]{\text{Im}\left(#1\right)}

\newcommand*{\qimg}[2]{\\ \begin{center}\includegraphics[scale=#1]{#2}\end{center}}

\newcommand*{\Arg}[1]{\text{Arg}\left(#1\right)}

\newcommand*{\Log}[1]{\text{Log}\left(#1\right)}

%%

\begin{document}

\begin{center}
    \subsection*{Solution: Speed of Sound in a Solid with Lagrangian Mechanics}
    James Wu, \quad 92277235
\end{center}

\begin{flushleft}

    \subsubsection*{Part I}
    There are $MNP$ atoms in this system. Each atom, being modelled as a point particle, has 3 degrees of freedom. However, we must subtract the atom at the origin, as we have constrained it to be fixed. Thus
    $$\boxed{s = 3(MNP - 1)}$$
    We can use the $x$, $y$, and $z$ coordinates of each particle to describe the particle's motion. Our generalized coordinates are then
    $$\boxed{\left(x_{ijk}, y_{ijk}, z_{ijk}\right), \: (0,0,0) \leq (i,j,k) \leq (M-1, N-1, P-1), (i,j,k) \neq (0,0,0)}$$
    where we index the atoms with $i$, $j$, and $k$ along the $x$-, $y$-, and $z$-axes, respectively.

    \subsubsection*{Part II}
    The equilibrium position of atom $(i,j,k)$ is
    $$\boxed{\left(\tilde{x}_{ijk}, \tilde{y}_{ijk}, \tilde{z}_{ijk}\right) = \left(il_0, jl_0, kl_0\right)}$$
    If we take the prism to be bounded by the point atoms, then the dimensions would be $(a,b,c) = ((M-1)l_0,(N-1)l_0,(P-1)l_0)$. Quasi-philosophically, we could, however, argue that the prism extends a bit beyond the boundary atoms; no external body can be pushed right against the boundary atoms as that would require an infinite amount of energy (the bond energy diverges to infinity as bond distance approaches zero). Regardless, this all occurs on the $l_0$ scale, which is small compared to the $(a,b,c)$ scale. Hence we simply assert
    $$\boxed{(a,b,c) \approx (Ml_0,Nl_0,Pl_0)}$$

    \subsubsection*{Part III}
    The kinetic energy of particle $(i,j,k)$ is simply
    $$T_{ijk} = \frac{m}{2}\left(\dot{x}_{ijk}^2 + \dot{y}_{ijk}^2 + \dot{z}_{ijk}^2\right)$$
    For the case $i=j=k=0$, we simply have $\dot{x}_{000} = \dot{y}_{000} = \dot{z}_{000} = 0$ as a constant. This means that $T_{000} = 0$, so we may add it to the total kinetic energy of the system (despite the $(0,0,0)$ atom not being part of the system):
    $$\boxed{T = \frac{m}{2}\sum_{i=0}^{M-1}\sum_{j=0}^{N-1}\sum_{k=0}^{P-1}\left(\dot{x}_{ijk}^2 + \dot{y}_{ijk}^2 + \dot{z}_{ijk}^2\right)}$$
    In what follows, we let $x_{000} = y_{000} = z_{000} = 0$ be constants. Then for a single spring along the $x$-axis connecting atoms $(i,j,k)$ and $(i+1,j,k)$, we have
    \begin{align*}
        U^x_{ijk} &= \frac{K}{2}\left(\abs{\mathbf{r}_{i+1,jk} - \mathbf{r}_{ijk}} - l_0\right)^2 \\
        &= \frac{K}{2}\left(\sqrt{(x_{i+1,j,k} - x_{ijk})^2 + (y_{i+1,j,k} - y_{ijk})^2 + (z_{i+1,j,k} - z_{ijk})^2} - l_0\right)^2
    \end{align*}
    Then the sum of kinetic energies amongst all the $x$-axis springs are
    $$U^x = \frac{K}{2}\sum_{i=0}^{M-2}\sum_{j=0}^{N-1}\sum_{k=0}^{P-1}\left(\sqrt{(x_{i+1,j,k} - x_{ijk})^2 + (y_{i+1,j,k} - y_{ijk})^2 + (z_{i+1,j,k} - z_{ijk})^2} - l_0\right)^2$$
    Applying isotropic symmetry yields analogous expressions in $y$ and $z$. Then the total kinetic energy $T = T^x + T^y + T^z$ (we neglect gravity in this problem) is
    \begin{empheq}[box=\wfbox]{align*}
        U &= \frac{K}{2}\sum_{i=0}^{M-2}\sum_{j=0}^{N-1}\sum_{k=0}^{P-1}\left(\sqrt{(x_{i+1,j,k} - x_{ijk})^2 + (y_{i+1,j,k} - y_{ijk})^2 + (z_{i+1,j,k} - z_{ijk})^2} - l_0\right)^2 \\
        &+ \frac{K}{2}\sum_{i=0}^{M-1}\sum_{j=0}^{N-2}\sum_{k=0}^{P-1}\left(\sqrt{(x_{i,j+1,k} - x_{ijk})^2 + (y_{i,j+1,k} - y_{ijk})^2 + (z_{i,j+1,k} - z_{ijk})^2} - l_0\right)^2 \\
        &+ \frac{K}{2}\sum_{i=0}^{M-1}\sum_{j=0}^{N-1}\sum_{k=0}^{P-2}\left(\sqrt{(x_{i,j+1,k} - x_{ijk})^2 + (y_{i,j+1,k} - y_{ijk})^2 + (z_{i,j+1,k} - z_{ijk})^2} - l_0\right)^2
    \end{empheq}
    Our Lagrangian is thus
    \begin{empheq}[box=\wfbox]{align*}
        \mathcal{L} &= \frac{m}{2}\sum_{i=0}^{M-1}\sum_{j=0}^{N-1}\sum_{k=0}^{P-1}\left(\dot{x}_{ijk}^2 + \dot{y}_{ijk}^2 + \dot{z}_{ijk}^2\right) \\
        &- \frac{K}{2}\sum_{i=0}^{M-2}\sum_{j=0}^{N-1}\sum_{k=0}^{P-1}\left(\sqrt{(x_{i+1,j,k} - x_{ijk})^2 + (y_{i+1,j,k} - y_{ijk})^2 + (z_{i+1,j,k} - z_{ijk})^2} - l_0\right)^2 \\
        &- \frac{K}{2}\sum_{i=0}^{M-1}\sum_{j=0}^{N-2}\sum_{k=0}^{P-1}\left(\sqrt{(x_{i,j+1,k} - x_{ijk})^2 + (y_{i,j+1,k} - y_{ijk})^2 + (z_{i,j+1,k} - z_{ijk})^2} - l_0\right)^2 \\
        &- \frac{K}{2}\sum_{i=0}^{M-1}\sum_{j=0}^{N-1}\sum_{k=0}^{P-2}\left(\sqrt{(x_{i,j+1,k} - x_{ijk})^2 + (y_{i,j+1,k} - y_{ijk})^2 + (z_{i,j+1,k} - z_{ijk})^2} - l_0\right)^2
    \end{empheq}
    As we will see in \textbf{Part IV}, $\pderiv{\mathcal{L}}{x_{ijk}} = m\dot{x}_{ijk}$, $\pderiv{\mathcal{L}}{y_{ijk}} = m\dot{y}_{ijk}$, and $\pderiv{\mathcal{L}}{z_{ijk}} = m\dot{z}_{ijk}$ are in general nonzero. Hence momenta are generally not conserved in this system. However, notice that the Lagrangian is time invariant: $\pderiv{\mathcal{L}}{t} = 0$. Thus energy is conserved.
    \begin{align*}
        E &= \mathcal{L} - \sum_{(i,j,k) \neq (0,0,0)} \left(\dot{x}_{ijk}\pderiv{\mathcal{L}}{\dot{x}_{ijk}} + \dot{y}_{ijk}\pderiv{\mathcal{L}}{\dot{y}_{ijk}} + \dot{z}_{ijk}\pderiv{\mathcal{L}}{\dot{z}_{ijk}}\right) \\
        &= \mathcal{L} - \sum_{(i,j,k) \neq (0,0,0)} \left(m\dot{x}_{ijk}^2 + m\dot{y}_{ijk}^2 + m\dot{z}_{ijk}^2\right) \\
        &= \mathcal{L} - m\sum \left(\dot{x}_{ijk}^2 + \dot{y}_{ijk}^2 + \dot{z}_{ijk}^2\right)
    \end{align*}
    In going to the last step, we leveraged the fact that $\dot{x}_{000} = \dot{y}_{000} = \dot{z}_{000} = 0$. Hence
    \begin{empheq}[box=\wfbox]{align*}
        E &= \frac{m}{2}\sum_{i=0}^{M-1}\sum_{j=0}^{N-1}\sum_{k=0}^{P-1}\left(\dot{x}_{ijk}^2 + \dot{y}_{ijk}^2 + \dot{z}_{ijk}^2\right) \\
        &+ \frac{K}{2}\sum_{i=0}^{M-2}\sum_{j=0}^{N-1}\sum_{k=0}^{P-1}\left(\sqrt{(x_{i+1,j,k} - x_{ijk})^2 + (y_{i+1,j,k} - y_{ijk})^2 + (z_{i+1,j,k} - z_{ijk})^2} - l_0\right)^2 \\
        &+ \frac{K}{2}\sum_{i=0}^{M-1}\sum_{j=0}^{N-2}\sum_{k=0}^{P-1}\left(\sqrt{(x_{i,j+1,k} - x_{ijk})^2 + (y_{i,j+1,k} - y_{ijk})^2 + (z_{i,j+1,k} - z_{ijk})^2} - l_0\right)^2 \\
        &+ \frac{K}{2}\sum_{i=0}^{M-1}\sum_{j=0}^{N-1}\sum_{k=0}^{P-2}\left(\sqrt{(x_{i,j+1,k} - x_{ijk})^2 + (y_{i,j+1,k} - y_{ijk})^2 + (z_{i,j+1,k} - z_{ijk})^2} - l_0\right)^2
    \end{empheq}

    \subsubsection*{Part IV}
    For convenience, let us introduce the antidelta
    $$\delta'_{mn} = 1 - \delta_{mn}$$
    Let us first obtain the equations for $x$. We shall then apply symmetry to obtain the equations for $y$ and $z$. Now for $(i,j,k) \neq (0,0,0)$ (this atom does not have any degrees of freedom),
    $$\pderiv{\mathcal{L}}{\dot{x}_{ijk}} = m\dot{x}_{ijk} \: \therefore \: \deriv{}{t}\pderiv{\mathcal{L}}{\dot{x}_{ijk}} = m\ddot{x}_{ijk}$$
    \begin{align*}
        \pderiv{\mathcal{L}}{x_{ijk}} &= K\left(\sqrt{(x_{i+1,j,k} - x_{ijk})^2 + (y_{i+1,j,k} - y_{ijk})^2 + (z_{i+1,j,k} - z_{ijk})^2} - l_0\right)\\&\mathrel{\phantom{=}}\frac{(x_{i+1,j,k} - x_{ijk})}{\sqrt{(x_{i+1,j,k} - x_{ijk})^2 + (y_{i+1,j,k} - y_{ijk})^2 + (z_{i+1,j,k} - z_{ijk})^2}}\delta'_{i,M-1} \\
        &- K\left(\sqrt{(x_{ijk} - x_{i-1,j,k})^2 + (y_{ijk} - y_{i-1,j,k})^2 + (z_{ijk} - z_{i-1,j,k})^2} - l_0\right)\\&\mathrel{\phantom{=}}\frac{(x_{ijk} - x_{i-1,jk})}{\sqrt{(x_{ijk} - x_{i-1,j,k})^2 + (y_{ijk} - y_{i-1,j,k})^2 + (z_{ijk} - z_{i-1,j,k})^2}}\delta'_{i,0} \\
        &+ K\left(\sqrt{(x_{i,j+1,k} - x_{ijk})^2 + (y_{i,j+1,k} - y_{ijk})^2 + (z_{i,j+1,k} - z_{ijk})^2} - l_0\right)\\&\mathrel{\phantom{=}}\frac{(x_{i,j+1,k} - x_{ijk})}{\sqrt{(x_{i,j+1,k} - x_{ijk})^2 + (y_{i,j+1,k} - y_{ijk})^2 + (z_{i,j+1,k} - z_{ijk})^2}}\delta'_{j,N-1} \\
        &- K\left(\sqrt{(x_{ijk} - x_{i,j-1,k})^2 + (y_{ijk} - y_{i,j-1,k})^2 + (z_{ijk} - z_{i,j-1,k})^2} - l_0\right)\\&\mathrel{\phantom{=}}\frac{(x_{ijk} - x_{i,j-1,k})}{\sqrt{(x_{ijk} - x_{i,j-1,k})^2 + (y_{ijk} - y_{i,j-1,k})^2 + (z_{ijk} - z_{i,j-1,k})^2}}\delta'_{j,0} \\
        &+ K\left(\sqrt{(x_{i,j,k+1} - x_{ijk})^2 + (y_{i,j,k+1} - y_{ijk})^2 + (z_{i,j,k+1} - z_{ijk})^2} - l_0\right)\\&\mathrel{\phantom{=}}\frac{(x_{i,j,k+1} - x_{ijk})}{\sqrt{(x_{i,j,k+1} - x_{ijk})^2 + (y_{i,j,k+1} - y_{ijk})^2 + (z_{i,j,k+1} - z_{ijk})^2}}\delta'_{k,P-1} \\
        &- K\left(\sqrt{(x_{ijk} - x_{i,j,k-1})^2 + (y_{ijk} - y_{i,j,k-1})^2 + (z_{ijk} - z_{i,j,k-1})^2} - l_0\right)\\&\mathrel{\phantom{=}}\frac{(x_{ijk} - x_{i,j,k-1})}{\sqrt{(x_{ijk} - x_{i,j,k-1})^2 + (y_{ijk} - y_{i,j,k-1})^2 + (z_{ijk} - z_{i,j,k-1})^2}}\delta'_{k,0}
    \end{align*}
    For further brevity, let us define
    $$\lambda^x_{i:m,n} = \frac{x_{mjk} - x_{njk}}{\sqrt{(x_{mjk} - x_{njk})^2 + (y_{mjk} - y_{njk})^2 + (z_{mjk} - z_{njk})^2}}$$
    We similarly define $\lambda^x_{j:m,n}$ and $\lambda^x_{k:m,n}$ substituting the $j$ and $k$ indices, respectively. Also define $\lambda^y$ and $\lambda^z$ to use $y$ and $z$ coordinates in the numerator instead. Then we simplify
    \begin{align*}
        \pderiv{\mathcal{L}}{x_{ijk}} &= K\left((x_{i+1,j,k} - x_{ijk}) - \lambda_{i:i+1,i}^xl_0\right)\delta'_{i,M-1} - K\left((x_{ijk} - x_{i-1,j,k}) - \lambda_{i:i,i-1}^xl_0\right)\delta'_{i,0} \\
        &+ K\left((x_{i,j+1,k} - x_{ijk}) - \lambda_{j:j+1,j}^xl_0\right)\delta'_{j,N-1} - K\left((x_{ijk} - x_{i,j-1,k}) - \lambda_{j:j,j-1}^xl_0\right)\delta'_{j,0} \\
        &+ K\left((x_{i,j,k+1} - x_{ijk}) - \lambda_{k:k+1,k}^xl_0\right)\delta'_{k,P-1} - K\left((x_{ijk} - x_{i,j,k-1}) - \lambda_{k:k,k-1}^xl_0\right)\delta'_{k,0}
    \end{align*}
    Applying symmetry to obtain the $y$ and $z$ equations, we obtain (for $(i,j,k) \neq (0,0,0)$)
    \begin{empheq}[box=\wfbox]{align*}
        m\ddot{x}_{ijk} &= K\left((x_{i+1,j,k} - x_{ijk}) - \lambda_{i:i+1,i}^xl_0\right)\delta'_{i,M-1} - K\left((x_{ijk} - x_{i-1,j,k}) - \lambda_{i:i,i-1}^xl_0\right)\delta'_{i,0} \\
        &+ K\left((x_{i,j+1,k} - x_{ijk}) - \lambda_{j:j+1,j}^xl_0\right)\delta'_{j,N-1} - K\left((x_{ijk} - x_{i,j-1,k}) - \lambda_{j:j,j-1}^xl_0\right)\delta'_{j,0} \\
        &+ K\left((x_{i,j,k+1} - x_{ijk}) - \lambda_{k:k+1,k}^xl_0\right)\delta'_{k,P-1} - K\left((x_{ijk} - x_{i,j,k-1}) - \lambda_{k:k,k-1}^xl_0\right)\delta'_{k,0} \\
        m\ddot{y}_{ijk} &= K\left((y_{i+1,j,k} - y_{ijk}) - \lambda_{i:i+1,i}^yl_0\right)\delta'_{i,M-1} - K\left((y_{ijk} - y_{i-1,j,k}) - \lambda_{i:i,i-1}^yl_0\right)\delta'_{i,0} \\
        &+ K\left((y_{i,j+1,k} - y_{ijk}) - \lambda_{j:j+1,j}^yl_0\right)\delta'_{j,N-1} - K\left((y_{ijk} - y_{i,j-1,k}) - \lambda_{j:j,j-1}^yl_0\right)\delta'_{j,0} \\
        &+ K\left((y_{i,j,k+1} - y_{ijk}) - \lambda_{k:k+1,k}^yl_0\right)\delta'_{k,P-1} - K\left((y_{ijk} - y_{i,j,k-1}) - \lambda_{k:k,k-1}^yl_0\right)\delta'_{k,0} \\
        m\ddot{z}_{ijk} &= K\left((z_{i+1,j,k} - z_{ijk}) - \lambda_{i:i+1,i}^zl_0\right)\delta'_{i,M-1} - K\left((z_{ijk} - z_{i-1,j,k}) - \lambda_{i:i,i-1}^zl_0\right)\delta'_{i,0} \\
        &+ K\left((z_{i,j+1,k} - z_{ijk}) - \lambda_{j:j+1,j}^zl_0\right)\delta'_{j,N-1} - K\left((z_{ijk} - z_{i,j-1,k}) - \lambda_{j:j,j-1}^zl_0\right)\delta'_{j,0} \\
        &+ K\left((z_{i,j,k+1} - z_{ijk}) - \lambda_{k:k+1,k}^zl_0\right)\delta'_{k,P-1} - K\left((z_{ijk} - z_{i,j,k-1}) - \lambda_{k:k,k-1}^zl_0\right)\delta'_{k,0}
    \end{empheq}

    \subsubsection*{Part V}
    At $t=0$, we have $y_{ijk} = jl_0$ and $z_{ijk} = kl_0$. Consequently, $y_{ijk}$ is invariant in $i$ and $k$, while $z_{ijk}$ is invariant in $i$ and $j$. This means that for $m > n$
    \begin{align*}
        \sqrt{(x_{mjk} - x_{njk})^2 + (y_{mjk} - y_{njk})^2 + (z_{mjk} - z_{njk})^2} &= \abs{x_{mjk} - x_{njk}} = x_{mjk} - x_{njk} \\
        \sqrt{(x_{imk} - x_{ink})^2 + (y_{imk} - y_{ink})^2 + (z_{imk} - z_{ink})^2} &= \abs{y_{imk} - y_{ink}} = y_{imk} - y_{ink} = (m-n)l_0 \\
        \sqrt{(x_{ijm} - x_{ijn})^2 + (y_{ijm} - y_{ijn})^2 + (z_{ijm} - z_{ijn})^2} &= \abs{z_{ijm} - z_{ijn}} = z_{ijm} - z_{ijn} = (m-n)l_0
    \end{align*}
    The absolute values resolve given that the oscillations about equilibrium points are assumed to be small; the spatial order of the atoms will therefore be preserved. Then
    $$(y_{i+1,j,k} - y_{ijk}) - \lambda^y_{i:i+1,i}l_0 = 0 - 0 = 0$$
    $$(y_{i,j+1,k} - y_{ijk}) - \lambda^y_{j:j+1,j}l_0 = l_0 - \frac{l_0}{l_0}l_0 = 0$$
    Similar calculations to the first equation can be done for the $k$ index to yield zero (for $i:i,i-1$ we simply shift the index). Adding terms together, this gives $m\ddot{y}_{ijk} = 0$ and so $\ddot{y}_{ijk} = 0$ at $t = 0$. By symmetry, we must have $\ddot{z}_{ijk} = 0$ initially.\qed\\
    We can also perform similar calculations for the terms replacing the $j$ and $k$ indices in the $x_{ijk}$ equation as we did for the term in the $y_{ijk}$ equation with $i:i+1,i$ to obtain zero. Meanwhile,
    $$\lambda_{i:i+1,i}^x = \frac{x_{i+1,j,k} - x_{ijk}}{\sqrt{(x_{i+1,j,k} - x_{ijk})^2}} = 1$$
    noting that the absolute value resolves. Shifting indices to apply this to $i:i,i-1$, we now attain
    $$m\ddot{x}_{ijk} = K\left((x_{i+1,j,k} - x_{ijk}) - l_0\right)\delta'_{i,M-1} - K\left((x_{ijk} - x_{i-1,j,k}) - l_0\right)\delta'_{i,0}$$
    At initial conditions, we reduce $x_{ijk} \mapsto x_i$ seeing that the $x_{ijk}$ is independent of $j$ and $k$. Then
    $$m\ddot{x}_{ijk} = K\left((x_{i+1} - x_{i}) - l_0\right)\delta'_{i,M-1} - K\left((x_{i} - x_{i-1}) - l_0\right)\delta'_{i,0}$$
    Seeing that the right-hand side is independent of $j$ and $k$ (and so is $m$), we have demonstrated that $\ddot{x}_{ijk}$ is independent of $j$ and $k$ (at initial conditions).\qed\\
    Indexing with $i$, we know have
    \begin{align*}
        m\ddot{x}_{i} &= K\left((x_{i+1} - x_{i}) - l_0\right)\delta'_{i,M-1} - K\left((x_{i} - x_{i-1}) - l_0\right)\delta'_{i,0}
    \end{align*}
    For $1 \leq i \leq M-2$ this simplifies to
    $$m\ddot{x}_i = K\left((x_{i+1} - x_{i}) - l_0\right) - K\left((x_{i} - x_{i-1}) - l_0\right) = K\left(x_{i+1} + x_{i-1} - 2x_i\right)$$
    $$\boxed{m\ddot{x}_i = K\left(x_{i+1} + x_{i-1} - 2x_i\right), \: 1 \leq i \leq M-2}$$
    As for $i = M-1$,
    $$\boxed{m\ddot{x}_{M-1} = -K\left((x_{M-1} - x_{M-2}) - l_0\right)}$$
    Note that $x_0$ is no longer a degree of freedom.\\
    Finally, note that $x_i = X_i + il_0$ and $\ddot{X}_i = \ddot{x}_i$. Then for $1 \leq i \leq M-2$,
    $$m\ddot{X}_i = K\left(X_{i+1} + (i+1)l_0 + X_{i-1} + (i-1)l_0 - 2\left(X_i + il_0\right)\right) = K\left(X_{i+1} + X_{i-1} - 2X_i\right)$$
    $$\boxed{m\ddot{X}_i = K\left(X_{i+1} + X_{i-1} - 2X_i\right), \: 1 \leq i \leq M-2}$$
    And for $i = M-1$
    $$m\ddot{X}_{M-1} = -K\left((X_{M-1} + (M-1)l_0 - X_{M-2} - (M-2)l_0) - l_0\right)$$
    $$\boxed{m\ddot{X}_{M-1} = -K\left(X_{M-1} - X_{M-2}\right)}$$

    \subsubsection*{Part VI}
    For the interior points, we rearrange the $X_i$ equation to get
    $$\ddot{X}_i = \frac{K}{m}\left(X_{i+1} + X_{i-1} - 2X_i\right)$$
    This equation looks similar to the second derivative difference equation. The mesh points are indexed at $i-1$, $i$, and $i+1$. Since $X_i$ describes the deviation from equilibrium at $\tilde{x}_i$, the mesh spacing must be the spacing in $\tilde{x}_i$. This is simply $l_0$. Thus,
    $$\boxed{\Delta x = l_0}$$
    Hence
    $$\boxed{\ddot{X}_i = \frac{Kl_0^2}{m}\frac{X_{i+1} + X_{i-1} - 2X_i}{l_0^2}}$$

    \subsubsection*{Part VII}
    The discrete equation corresponds to the differential equation
    $$\npderiv{\tilde{X}}{t}{2} = \frac{Kl_0^2}{m}\npderiv{\tilde{X}}{x}{2}$$
    Seeing that $X$ is constant in $j$ and $k$, we have $\tilde{X}$ be constant in $y$ and $z$. Then $\npderiv{\tilde{X}}{y}{2} = \npderiv{\tilde{X}}{z}{2} = 0$. This means that $\nabla^2 \tilde{X} = \npderiv{\tilde{X}}{t}{2}$. Hence
    $$\boxed{\npderiv{\tilde{X}}{t}{2} = \frac{Kl_0^2}{m}\nabla^2\tilde{X}}$$
    This gives $c^2 = \frac{Kl_0^2}{m}$. Thus
    $$\boxed{c = l_0\sqrt{\frac{K}{m}}}$$
    In numerical applications, time must be discretized as well. However, in our equations, time is a continuum. Therefore the discrete equations serve as a better approximation to the wave differential equation than a full discretization would.

    \subsubsection*{Part VIII}
    Notice that $j$ and $k$ symmetries are preserved when we deform $x_{Mjk}$ by $\delta$. Then we use the equations for $X_i$ from \textbf{Part V}. At rest, $\ddot{X}_i = \ddot{x}_i = 0$. We then have the equations
    $$X_{i+1} + X_{i-1} - 2X_i = 0$$
    for $1 \leq i \leq M-2$. Moreover, we have the boundary conditions $X_0 = 0$ and $X_{M-1} = \delta$. We may rearrange the $X_i$ equation to
    $$X_i = \frac{X_{i+1} + X_{i-1}}{2}$$
    That is, $X_i$ is the average value of its two neighbours. We now have $M$ linear equations in $M$ unknowns (two equations are from the boundary conditions). The coefficient matrix is tridiagonal and therefore invertible. Hence there is a unique solution to these equations. By inspection, the solution is
    $$X_i = \frac{i}{M} \delta$$
    for $0 \leq i \leq M-1$. Notice that under $j$ and $k$ symmetry, the potential energy simplifies to
    \begin{align*}
        U &= \frac{K}{2}\sum_{i=0}^{M-2}\sum_{j=0}^{N-1}\sum_{k=0}^{P-1}\left((x_{i+1,j,k} - x_{ijk}) - l_0\right)^2 = \frac{NPK}{2}\sum_{i=0}^{M-2}\left((x_{i+1} - x_{i}) - l_0\right)^2 \\
        &= \frac{NPK}{2}\sum_{i=0}^{M-2}\left((X_{i+1} + (i+1)l_0 - X_{i} - il_0) - l_0\right)^2 = \frac{NPK}{2}\sum_{i=0}^{M-2}\left(X_{i+1} - X_{i}\right)^2 \\
        &= \frac{NPK}{2}\sum_{i=0}^{M-2}\left(\frac{\delta}{M}\right)^2 = \frac{(M-1)NPK\delta^2}{2M^2} \approx \frac{NPK\delta^2}{2M}
    \end{align*}
    Noting that $U = 0$ when there is no deformation ($\delta = 0$), we equate
    \begin{align*}
        \frac{1}{2}E\epsilon^2 = \frac{1}{2}E\frac{\delta^2}{a^2} &= \frac{\Delta U}{V} = \frac{U}{abc} = \frac{1}{MNPl_0^3} \frac{NPK\delta^2}{2M} \\
        E\frac{1}{a^2} = E\frac{1}{M^2l_0^2} &= \frac{1}{MNPl_0^3} \frac{NPK}{M} \\
        E &= \frac{1}{MNPl_0^3} MNPKl_0^2 = \frac{K}{l_0}
    \end{align*}
    Meanwhile, for (average) density we have
    $$\rho = \frac{m_{total}}{V} = \frac{MNPm}{MNPl_0^3} = \frac{m}{l_0^3}$$
    We now have $K = El_0$ and $m = \rho l_0^3$. Then
    $$c = l_0\sqrt{\frac{K}{m}} = l_0\sqrt{\frac{El_0}{\rho l_0^3}} = \sqrt{\frac{E}{\rho l_0^2}}$$
    $$\boxed{c = \sqrt{\frac{E}{\rho}}}$$
    We have now accomplished our main objective in this problem: to determine the speed of sound in a solid in terms of its macroscopic properties.

    \subsubsection*{Part IX}
    \underline{Dirichlet BCs}\\
    Trivially, this corresponds to simply fixing the $x=a$ face at a certain $x$-coordinate $x=p$. Notice that $x_{M-1,j,k}$ are no longer degrees of freedom.\newline\newline
    \underline{Mixed BCs}\\
    Let us now introduce a ghost mesh point $X_M$ in discretizing $\tilde{X}$. Then we may rewrite
    $$mX_{M-1} = -K(X_{M-1} - X_{M-2}) = K(X_{M} + X_{M-2} - 2X_{M-1}) - K(X_M - X_{M-1})$$
    If we discretize
    $$\deriv{\tilde{X}}{x}(x=a,y,z,t) = \frac{X_M - X_{M-1}}{l_0}$$
    So in the case of mixed boundary conditions
    $$mX_{M-1} = K(X_{M} + X_{M-2} - 2X_{M-1}) - Kl_0q$$
    This means that the mixed boundary condition corresponds to a constant force $F$ being applied uniformly on the $x=a$ face. To see why, we first see that our potential energy has an additional terms $-fx_{M-1,j,k}$ for all $j$ and $k$ in bounds. Then the Lagrangian would have the terms $+fx_{M-1,j,k}$. Differentiating into the EL equations gives a $+f$ term:
    $$mX_{M-1} = K(X_{M} + X_{M-2} - 2X_{M-1}) - Kl_0q + f$$
    Here $f$ is the force applied on each atom. Uniform application of the force maintains $j$ and $k$ symmetry. It follows that $F = NPf$. Applying the discretization of $\npderiv{\tilde{X}}{t}{2} = c^2\npderiv{\tilde{X}}{x}{2}$ to the $M-1$ mesh point, we then have
    $$mX_{M-1} = K(X_{M} + X_{M-2} - 2X_{M-1})$$
    This means that $f = Kl_0q$. Then
    $$F = NPKl_0q = \frac{K}{l_0}NPl_0^2q = Ebcq$$
    $$\boxed{F = qEA}$$
    \underline{Robin BCs}\\
    In this case we have
    \begin{align*}
        \beta\deriv{\tilde{X}}{x}(x=a,y,z,t) &= \gamma - \alpha\tilde{X}(x=a,y,z,t) \\
        \deriv{\tilde{X}}{x}(x=a,y,z,t) &= \frac{\gamma}{\beta} - \frac{\alpha}{\beta}\tilde{X}(x=a,y,z,t)
    \end{align*}
    Then
    \begin{align*}
        mX_{M-1} &= K(X_{M} + X_{M-2} - 2X_{M-1}) - K(X_M - X_{M-1}) \\
        &= K(X_{M} + X_{M-2} - 2X_{M-1}) - Kl_0\left(\frac{\gamma}{\beta} - \frac{\alpha}{\beta}X_{M-1}\right) \\
        &= K(X_{M} + X_{M-2} - 2X_{M-1}) + \frac{\alpha Kl_0}{\beta}\left(X_{M-1} - \frac{\gamma}{\alpha}\right)
    \end{align*}
    This corresponds to a spring of spring constant $\kappa$ and equilibrium length $L_0$ being uniformly applied to the $x=a$ face. Let $\kappa'$ be the effective spring constant on each atom. Then the potential energy gains a $+\frac{\kappa'}{2}\left(x_{M-1,j,k} - L_0\right)^2$ term. Conversely, the Lagrangian gains a $-\frac{\kappa'}{2}\left(x_{M-1,j,k} - L_0\right)^2$ term. So the EL equation for $x_{M-1} \to X_{M-1}$ gains a $-\kappa'\left(x_{M-1} - L_0\right)$ term (note the $j$ and $k$ symmetries being preserved):
    $$mX_{M-1} = K(X_{M} + X_{M-2} - 2X_{M-1}) + \frac{\alpha Kl_0}{\beta}\left(X_{M-1} - \frac{\gamma}{\alpha}\right) - \kappa'\left(x_{M-1} - L_0\right)$$
    It follows that $\kappa' = \frac{\alpha Kl_0}{\beta}$ and
    $$\boxed{L_0 = \frac{\gamma}{\alpha}}$$
    Of course, for the limiting case $\beta \to 0$ (in the direction of sign that agrees with $\alpha$) we have a fully rigid spring holding the face fixed at $x = \frac{\gamma}{\alpha}$ (we will see shortly that $\kappa$ is proportional to $\kappa'$); this agrees with our result for the Dirichlet condition that would be obtained. To relate $\kappa'$ with $\kappa$, we equate the spring energies taking across the entire $x=a$ face:
    $$\frac{\kappa}{2} \left(x_{M-1} - L_0\right)^2 = \sum_{j=0}^{N-1}\sum_{k=0}^{P-1}\frac{\kappa'}{2} \left(x_{M-1} - L_0\right)^2 = NP\frac{\kappa'}{2} \left(x_{M-1} - L_0\right)^2$$
    This gives us $\kappa = NP\kappa'$. Thus
    $$\kappa = NP\frac{\alpha Kl_0}{\beta} = \frac{\alpha}{\beta} \frac{K}{l_0} NPl_0^2 = \frac{\alpha}{\beta}EA$$
    We box this as
    $$\boxed{\kappa = \frac{\alpha}{\beta}EA}$$
    Of course, $\alpha$ and $\beta$ must agree in sign for this spring to be stable. Then for the limiting case $\alpha \to 0$, we first rearrange the spring force to be
    $$F = -\kappa\left(x_{M-1} - L_0\right) = \kappa L_0\left(1 - \frac{x_{M-1}}{L_0}\right) = \frac{\gamma}{\beta}EA\left(1 - \frac{x_{M-1}}{L_0}\right) = \frac{\gamma}{\beta}EA\left(1 - \frac{\alpha}{\gamma}x_{M-1}\right)$$
    We see that as $\alpha \to 0$ we obtain $F = \frac{\gamma}{\beta}EA$, agreeing with our result for the mixed boundary condition. Interestingly, the sign of $\alpha$ need not agree with that of $\beta$ in the limit to recover this relationship.

\end{flushleft}

\end{document}
